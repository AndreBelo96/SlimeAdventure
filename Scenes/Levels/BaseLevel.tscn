[gd_scene load_steps=23 format=3 uid="uid://epn6jxi3iejh"]

[ext_resource type="Script" path="res://Scripts/Levels/LevelManager.gd" id="1_l5mnm"]
[ext_resource type="Script" path="res://Scripts/Levels/LevelLogic.gd" id="2_1s4qq"]
[ext_resource type="TileSet" uid="uid://xy61pbjpfef8" path="res://Tilesets/tile_set.tres" id="2_ljv4m"]
[ext_resource type="PackedScene" uid="uid://co1o3jnm2k22u" path="res://Player/player.tscn" id="2_xyu3k"]
[ext_resource type="PackedScene" uid="uid://e1xgk7yp8d0f" path="res://Scenes/Backgrounds/BackgroundManager.tscn" id="3_lq64p"]
[ext_resource type="Texture2D" uid="uid://2u58orbnfe0e" path="res://Assets/Sprites/Tiles/Logic/logic_set.png" id="3_orymm"]
[ext_resource type="TileSet" uid="uid://bi8t1sts5s8k8" path="res://Tilesets/wall_set.tres" id="4_3jiy3"]
[ext_resource type="PackedScene" uid="uid://bfj77cmvhy0xn" path="res://Scenes/UI/Pause.tscn" id="4_k28r4"]
[ext_resource type="FontFile" uid="uid://cl2j3sd1wf5ch" path="res://Assets/Fonts/Chewy-Regular.ttf" id="5_662ev"]
[ext_resource type="Texture2D" uid="uid://8muq26gnwoie" path="res://Assets/Sprites/Tiles/Logic/MovementLogicTIleMap.png" id="5_ds48i"]
[ext_resource type="TileSet" uid="uid://bjlusfts0e6u6" path="res://Tilesets/torch_set.tres" id="5_idd1r"]
[ext_resource type="TileSet" uid="uid://dvw5f0e610k6" path="res://Tilesets/pickup_set.tres" id="7_6r6ib"]
[ext_resource type="PackedScene" uid="uid://dfpv6fhikmmav" path="res://Scenes/UI/DialogInterface.tscn" id="7_28dga"]
[ext_resource type="TileSet" uid="uid://bfdegxpjgd1n3" path="res://Tilesets/stair_set.tres" id="8_p3cyg"]
[ext_resource type="TileSet" uid="uid://cmuwmspta6dkl" path="res://Tilesets/npc_set.tres" id="11_3rmix"]
[ext_resource type="Script" path="res://Scripts/Levels/LevelHUDManager.gd" id="11_vokoc"]
[ext_resource type="TileSet" uid="uid://dwiuj3egvhemc" path="res://Tilesets/doors_set.tres" id="12_iw06x"]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_ahpxb"]
texture = ExtResource("3_orymm")
texture_region_size = Vector2i(64, 32)
0:0/0 = 0
0:0/0/texture_origin = Vector2i(0, -3)
0:0/0/custom_data_0 = "A"
1:0/0 = 0
1:0/0/texture_origin = Vector2i(0, -3)
1:0/0/custom_data_0 = "B"
2:0/0 = 0
2:0/0/texture_origin = Vector2i(0, -3)
2:0/0/custom_data_0 = "C"
3:0/0 = 0
3:0/0/texture_origin = Vector2i(0, -3)
3:0/0/custom_data_0 = "D"
4:0/0 = 0
4:0/0/texture_origin = Vector2i(0, -3)
4:0/0/custom_data_0 = "E"
5:0/0 = 0
5:0/0/texture_origin = Vector2i(0, -3)
5:0/0/custom_data_0 = "F"
6:0/0 = 0
6:0/0/texture_origin = Vector2i(0, -3)
6:0/0/custom_data_0 = "G"
7:0/0 = 0
7:0/0/texture_origin = Vector2i(0, -3)
7:0/0/custom_data_0 = "H"
8:0/0 = 0
8:0/0/texture_origin = Vector2i(0, -3)
8:0/0/custom_data_0 = "I"
9:0/0 = 0
9:0/0/texture_origin = Vector2i(0, -3)
9:0/0/custom_data_0 = "EXIT"

[sub_resource type="TileSet" id="TileSet_w0n8b"]
tile_shape = 1
tile_layout = 5
tile_size = Vector2i(64, 24)
custom_data_layer_0/name = "chiave"
custom_data_layer_0/type = 4
sources/2 = SubResource("TileSetAtlasSource_ahpxb")

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_i0kmu"]
texture = ExtResource("5_ds48i")
margins = Vector2i(1, 1)
separation = Vector2i(2, 2)
texture_region_size = Vector2i(64, 25)
use_texture_padding = false
0:0/0 = 0
1:0/0 = 0
1:0/0/custom_data_0 = 1
2:0/0 = 0
2:0/0/custom_data_0 = 4
3:0/0 = 0
3:0/0/custom_data_0 = 2
3:1/0 = 0
3:1/0/custom_data_0 = 5
3:2/0 = 0
3:2/0/custom_data_0 = 14
3:3/0 = 0
3:3/0/custom_data_0 = 8
2:3/0 = 0
2:3/0/custom_data_0 = 6
2:2/0 = 0
2:2/0/custom_data_0 = 7
2:1/0 = 0
2:1/0/custom_data_0 = 9
1:1/0 = 0
1:1/0/custom_data_0 = 3
1:2/0 = 0
1:2/0/custom_data_0 = 13
1:3/0 = 0
1:3/0/custom_data_0 = 10
0:3/0 = 0
0:3/0/custom_data_0 = 11
0:2/0 = 0
0:2/0/custom_data_0 = 12
0:1/0 = 0
0:1/0/custom_data_0 = 15

[sub_resource type="TileSet" id="TileSet_duywq"]
tile_shape = 1
tile_layout = 5
tile_size = Vector2i(64, 24)
custom_data_layer_0/name = "MovementMask"
custom_data_layer_0/type = 2
sources/0 = SubResource("TileSetAtlasSource_i0kmu")

[sub_resource type="CompressedTexture2D" id="CompressedTexture2D_auecd"]
load_path = "res://.godot/imported/Tileset.png-e9b3b182e6834cf2faf469c423b44388.ctex"

[node name="Level" type="Node2D"]
script = ExtResource("1_l5mnm")

[node name="LevelLogic" type="Node" parent="." node_paths=PackedStringArray("player", "tile_layer")]
script = ExtResource("2_1s4qq")
player = NodePath("../YSort/Player")
tile_layer = NodePath("../TileMapLayer")

[node name="BackgroundManager" parent="." instance=ExtResource("3_lq64p")]

[node name="LogicMapLayer" type="TileMapLayer" parent="."]
z_index = -15
texture_filter = 1
texture_repeat = 1
tile_set = SubResource("TileSet_w0n8b")

[node name="MovementLogicMapLayer" type="TileMapLayer" parent="."]
z_index = -15
tile_set = SubResource("TileSet_duywq")

[node name="TileMapLayer" type="TileMapLayer" parent="."]
z_index = -1
y_sort_enabled = true
texture_filter = 1
texture_repeat = 1
tile_set = ExtResource("2_ljv4m")

[node name="YSort" type="Node2D" parent="."]
y_sort_enabled = true

[node name="BackWallMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
texture_filter = 1
texture_repeat = 1
tile_set = ExtResource("4_3jiy3")

[node name="WallMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
texture_filter = 1
texture_repeat = 1
tile_set = ExtResource("4_3jiy3")

[node name="DecorationMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
texture_filter = 1
texture_repeat = 1

[node name="DoorsMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
tile_set = ExtResource("12_iw06x")

[node name="PickupMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
tile_set = ExtResource("7_6r6ib")

[node name="StairMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
texture_filter = 1
texture_repeat = 1
tile_set = ExtResource("8_p3cyg")

[node name="NPCMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
tile_set = ExtResource("11_3rmix")

[node name="Player" parent="YSort" instance=ExtResource("2_xyu3k")]
tile_map_layer_path = NodePath("../../TileMapLayer")
pickup_map_layer_path = NodePath("../PickupMapLayer")
movement_logic_map_layer_path = NodePath("../../MovementLogicMapLayer")
doors_map_layer_path = NodePath("../DoorsMapLayer")
npc_map_layer_path = NodePath("../NPCMapLayer")

[node name="TorchMapLayer" type="TileMapLayer" parent="YSort"]
y_sort_enabled = true
tile_set = ExtResource("5_idd1r")

[node name="DarkOverlay" type="CanvasModulate" parent="."]
visible = false
color = Color(0, 0, 0, 1)

[node name="CanvasHUD" type="CanvasLayer" parent="."]

[node name="HUD" type="Control" parent="CanvasHUD"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("11_vokoc")

[node name="TimeLabel" type="Label" parent="CanvasHUD/HUD"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -174.0
offset_top = 10.0
offset_right = -26.0
offset_bottom = 63.0
grow_horizontal = 0
theme_override_fonts/font = ExtResource("5_662ev")
theme_override_font_sizes/font_size = 40
text = "Tempo : 0"
horizontal_alignment = 2

[node name="Base" type="Control" parent="CanvasHUD/HUD"]
layout_mode = 1
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -96.0
grow_horizontal = 2
grow_vertical = 0

[node name="StepsLabel" type="Label" parent="CanvasHUD/HUD/Base"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 50.0
offset_right = 50.0
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("5_662ev")
theme_override_font_sizes/font_size = 40
text = "Passi: 0"
vertical_alignment = 1

[node name="Control" type="Control" parent="CanvasHUD/HUD/Base"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="TileToActive" type="Label" parent="CanvasHUD/HUD/Base/Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("5_662ev")
theme_override_font_sizes/font_size = 40
text = "12/16"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Sprite2D" type="Sprite2D" parent="CanvasHUD/HUD/Base/Control"]
position = Vector2(755, 46)
scale = Vector2(1.23438, 1.40625)
texture = SubResource("CompressedTexture2D_auecd")
region_enabled = true
region_rect = Rect2(384, 0, 64, 32)

[node name="DialogInterface" parent="CanvasHUD" node_paths=PackedStringArray("player", "level_manager") instance=ExtResource("7_28dga")]
visible = false
player = NodePath("../../YSort/Player")
level_manager = NodePath("../..")

[node name="Pause" parent="CanvasHUD" instance=ExtResource("4_k28r4")]
